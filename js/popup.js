window.addEventListener("DOMContentLoaded",function(){document.getElementById("menu_list").addEventListener("click",function(b){change_menu_state(b,!0);localStorage.lastRub=b.target.id;fill_in_container(b.target.id)},!1);var d;chrome.extension.sendRequest({message:"getNewActusCount"},function(b){d=b;checkSectionToOpen(d);chrome.extension.sendRequest({message:"clearNewActusCount"});show_header(!1);fill_in_container(localStorage.lastRub)})},!1);
function checkSectionToOpen(d){if(!localStorage.lastRub||d&&0<parseInt(d))localStorage.lastRub="home";else if(localStorage.PCiForumLastCheck&&(d=JSON.parse(localStorage.PCiForumLastCheck),d.messages&&d.notifications&&(0<d.messages.count||0<d.notifications.count)))localStorage.lastRub="forum";"home"!=localStorage.lastRub&&change_menu_state(document.getElementById(localStorage.lastRub),!1)}
function change_menu_state(d,b){for(var c=b?d.target:d,a=0;a<c.parentNode.parentNode.getElementsByTagName("a").length;a++){var e=c.parentNode.parentNode.getElementsByTagName("a")[a].id;document.getElementById("li-"+e).className=""}document.getElementById("li-"+c.id).className="active"}function empty_zone(d){for(;d.hasChildNodes();)d.removeChild(d.childNodes[0])}
function show_header(d){var b=document.getElementById("user_zone"),c=document.getElementById("welcome"),a=document.getElementById("thanks"),e=document.getElementById("li-premium");b.style.display=d?"none":"block";chrome.extension.sendRequest({message:"ask_user_cache"},function(b){var d=b.IsPremium?b.Login:"",g=document.createElement("H3");c.appendChild(g);var h=document.createElement("H3"),j=document.createElement("Small");a.appendChild(h);h.appendChild(j);g.innerText="Bienvenue, "+d;b.IsRegistered&&
(d=document.createElement("span"),d.innerText="X",d.id="menu_deco",d.style.cursor="pointer",d.style.color="white",d.title="Vous d\u00e9connecter de PC INpact",g.appendChild(d),document.getElementById("menu_deco").addEventListener("click",function(){chrome.tabs.create({url:"http://www.pcinpact.com/Account/LogOff?url=http%3A%2F%2Fwww.pcinpact.com%2F"})}));!0==b.IsPremium?(a.innerText=" Merci pour votre abonnement Premium !",e.style.display="block"):(b=document.createElement("a"),b.href="http://www.pcinpact.com/abonnement",
b.target="_blank",b.innerText="abonnement Premium",b.style.color="white",b.title="Abonnez-vous !",a.innerText=" PC INpact, plus INd\u00e9pendant, sans publicit\u00e9 : ",a.appendChild(b),e.style.display="none")})}
function fill_in_container(d){var b=document.getElementById("bloc_central");document.getElementById("footer").style.display="none";switch(d){case "bp":chrome.extension.sendRequest({message:"ask_bp_cache"},function(c){update_content_bp(b,c)});break;case "cal":update_content_cal(b);break;case "emploi":chrome.extension.sendRequest({message:"askEmploiCache"},function(c){update_content_emploi(b,c)});break;case "forum":chrome.extension.sendRequest({message:"ask_forum_cache"},function(c){update_content_forum(b,
c)});break;case "premium":chrome.extension.sendRequest({message:"ask_user_cache"},function(c){update_content_premium(b,c)});break;case "search":update_content_search(b);break;default:chrome.extension.sendRequest({message:"ask_news_cache"},function(c){update_content_news(b,c,d)})}}function setFooter(d){var b=document.getElementById("footer");b.innerText=d;b.style.display=""===d?"none":"block"};function update_content_bp(d,b){var c=function(a){var b=document.createElement("div");b.className="blocActu";var c=document.createElement("div"),e=document.createElement("a");e.target="_blank";e.href=a.url;e.innerText=a.titre;var j=document.createElement("div");j.innerText=a.date;j.className="ss_titre";var k=document.createElement("img");k.src=a.categorie.img;k.align="left";k.hspace=5;d.appendChild(b);b.appendChild(k);b.appendChild(c);c.appendChild(e);b.appendChild(j)};empty_zone(d);var a=document.createElement("div");
a.innerText="Les 10 bons plans les plus populaires du moment";a.className="alert alert-info bloc-date";d.appendChild(a);for(var e in b.list)c(b.list[e]);c=document.createElement("div");c.className="alert alert-info bloc-fin";c.align="center";c.style.cursor="pointer";c.innerText="Acc\u00e9der \u00e0 tous les bons plans";c.id="all_bp";d.appendChild(c);document.getElementById("all_bp").addEventListener("click",function(){chrome.tabs.create({url:"http://www.prixdunet.com/bon-plan.html?page=1&type=0&motcle=&order=nb_lectures&waypopu=desc"})},
!1);setFooter("Derni\u00e8re mise \u00e0 jour : "+(new Date(b.lastUpdateDate)).toFR(!0))};function update_content_cal(d){empty_zone(d);var b=document.createElement("iframe");b.style.borderWidth=0;b.src="https://www.google.com/calendar/embed?hl=fr&showPrint=0&height=600&wkst=1&bgcolor=%23FFFFFF&src=s8g7dr50a615kbi8cmm58ojv9k%40group.calendar.google.com&color=%23853104&src=ffpfmo9cpe4ldlb6l36dugq9t0%40group.calendar.google.com&color=%23182C57&ctz=Europe%2FParis";b.width=650;b.height=440;b.frameBorder=0;b.scrolling="no";b.innerText="";d.appendChild(b)};function update_content_emploi(d,b){empty_zone(d);var c=b.list,a=b.lastUpdateDate;if(0===c.length){c=document.createElement("p");c.innerText="Aucune offre d'emploi n'a \u00e9t\u00e9 trouv\u00e9e. Un probl\u00e8me ? Retrouvez les ";c.className="alert alert-error message_center";var e=document.createElement("a");e.innerText="sur notre site";e.href="http://www.pcinpact.com/emploi/";e.target="_blank";var f=document.createTextNode(".");d.appendChild(c);c.appendChild(e);c.appendChild(f)}else{for(e=0;e<
c.length;e++){f=document.createElement("div");f.className="blocActu";var i=document.createElement("img");i.src="http://www.pcinpact.com/images/common/remixJob/avatar-entreprise.jpg";i.align="left";i.hspace=5;i.width=75;i.style="border:1px solid black";var g=document.createElement("a");g.href=c[e].url;g.innerText=c[e].title;g.target="_blank";var h=document.createElement("div");h.className="ss_titre";h.innerText=c[e].description;d.appendChild(f);f.appendChild(i);f.appendChild(g);f.appendChild(h)}c=
document.createElement("div");c.className="alert alert-info bloc-fin";c.align="center";c.style.cursor="pointer";c.innerText="Acc\u00e9der \u00e0 toutes les offres d'emploi";c.id="all_offres";d.appendChild(c);document.getElementById("all_offres").addEventListener("click",function(){chrome.tabs.create({url:"http://www.pcinpact.com/emploi"})},!1)}setFooter("Derni\u00e8re mise \u00e0 jour : "+(new Date(a)).toFR(!0));document.getElementById("messageZone").focus()};function update_content_forum(d,b){empty_zone(d);d.appendChild(function(){var c=document.createElement("div");if(b.isLoggedIn){c.style.fontWeight="bold";c.className="well message_center black_link";var a=document.createElement("a"),d=document.createElement("a");a.href=b.messages.url;d.href=b.notifications.url;a.innerText=1<b.messages.count?b.messages.count+" nouveaux messages":b.messages.count+" nouveau message";d.innerText=1<b.notifications.count?b.notifications.count+" notifications":b.notifications.count+
" notification";a.target=d.target="_blank";c.appendChild(a);c.appendChild(d);var f=document.createTextNode("Vous avez "),i=document.createTextNode(" et ");a.parentNode.insertBefore(f,a);d.parentNode.insertBefore(i,d)}else c.innerText="Vous n'\u00eates pas connect\u00e9 sur ",c.className="alert alert-error message_center",a=document.createElement("a"),a.href="http://forum.pcinpact.com/index.php?app=core&module=global&section=login",a.target="_blank",a.innerText="le forum",c.appendChild(a);return c}());
d.appendChild(function(){var c=document.createElement("div");c.style.fontWeight="bold";c.className="alert alert-info message_center";c.innerText="Le gagnant du t-shirt du jour est : ";var a=document.createElement("a");a.href=b.gagnant.url;a.innerText=b.gagnant.name;c.appendChild(a);return c}())};function update_content_news(d,b,c){empty_zone(d);(function(){for(var a in b.List){var e=document.createElement("div");e.innerText=b.List[a].PublishDate.date;e.className="alert alert-info bloc-date message_center";var f=document.createElement("div");f.className="blocActu";var i=document.createElement("img");i.src=b.List[a].DedicatedImgUrl;i.className="actuIcone";var g=document.createElement("a");g.href=b.List[a].AbsoluteUrl;g.target="_blank";var h=document.createElement("a");h.href=b.List[a].AbsoluteUrl;
h.target="_blank";b.List[a].IsBreve&&"home"==c?h.innerHTML="[Br\u00e8ve] "+b.List[a].Title:h.innerText=b.List[a].Title;h.className="titre";var j=document.createElement("img");j.src="/pics/flamme16px.png";j.title="Les essentiels du jour";j.align="right";var k=document.createElement("span");k.className="commentBloc";e=document.createElement("a");e.className="badge";0<b.List[a].NbComments&&(e.className+=" badge-info");e.target="_blank";e.href=b.List[a].AbsoluteUrl+"?vc=1";e.innerText=b.List[a].NbComments;
var l=document.createElement("p");l.className="dateBloc";l.innerText=b.List[a].PublishDate.old_format.dateFromDotNet().toIlya()+" - ";var m=document.createElement("span");m.className="ss_titre";m.innerText=b.List[a].SubTitle+" ";d.appendChild(f);f.appendChild(g);g.appendChild(i);f.appendChild(h);b.List[a].IsImportant&&f.appendChild(j);f.appendChild(l);l.appendChild(m);m.appendChild(k);f=function(){var c=document.createElement("a");c.target="_blank";c.href=b.List[a].LastCommentUrl;c.innerText="+"+
b.List[a].NbNewComments;k.appendChild(c);if(b.List[a].NbNewComments>0&&b.List[a].NbNewComments!=b.List[a].NbComments)c.className="badge badge-important";else if(b.List[a].NbNewComments==0&&b.List[a].NbComments!=0)c.className="badge badge-defaut";return c};null!=b.List[a].LastCommentUrl&&void 0!=b.List[a].NbNewComments&&(k.appendChild(f()),k.appendChild(document.createTextNode(" ")));k.appendChild(e)}})();(function(){var a=document.createElement("div");a.className="alert alert-info bloc-fin";a.align=
"center";a.style.cursor="pointer";switch(c){case "actus":a.innerText="Acc\u00e9der \u00e0 toutes les actualit\u00e9s";a.id="all_actus";d.appendChild(a);document.getElementById("all_actus").addEventListener("click",function(){chrome.tabs.create({url:"http://www.pcinpact.com"})},!1);break;case "breves":a.innerText="Acc\u00e9der \u00e0 toutoutes les br\u00e8ves",a.id="all_breves",d.appendChild(a),document.getElementById("all_breves").addEventListener("click",function(){chrome.tabs.create({url:"http://www.pcinpact.com/toutes-les-breves.htm"})},
!1)}})();setFooter("Derni\u00e8re mise \u00e0 jour : "+(new Date(b.lastUpdateDate)).toFR(!0))};function update_content_premium(d,b){empty_zone(d);if(b.IsPremium){var c=document.createElement("div"),a=document.createElement("div"),e=document.createElement("h3");e.innerText="URL Premium :";var f=document.createElement("div");f.className="well message_center black_link cutIfTooLong";var i=document.createElement("a");i.innerText=b.PremiumInfo.UrlRss;i.href=b.PremiumInfo.UrlRss;i.target="_blank";var g=document.createElement("div"),h=document.createElement("h3");h.innerText="QR Code Premium :";var j=
document.createElement("div"),k=document.createElement("img");k.src=localStorage.qrCodeBlob?localStorage.qrCodeBlob:b.PremiumInfo.UrlQr;k.alt="QR Code";j.className="well message_center";var l=document.createElement("div");l.innerText="Date d'expiration de votre compte : "+b.PremiumInfo.Expiration.dateFromDotNet().toFR(!0);l.className="alert alert-info message_center";l.style.fontWeight="bold";d.appendChild(c);c.appendChild(a);a.appendChild(e);a.appendChild(f);f.appendChild(i);c.appendChild(g);g.appendChild(h);
g.appendChild(j);j.appendChild(k);c.appendChild(l)}else localStorage.lastRub="home",fill_in_container(localStorage.lastRub)};function update_content_search(d){empty_zone(d);var b="Actualit\u00e9s Commentaires Dossiers Emploi Tests INpactiens".split(" "),c=["Actualit\u00e9s","Bons plans","Dossiers","Produits","Tests"];(function(){var a=document.createElement("div");a.className="pciSearchBox";var c=document.createElement("h3");c.innerText="PC INact :";var f=document.createElement("form");f.className="well form-search";var i=document.createElement("div");i.className="input-append";var g=document.createElement("input");g.type=
"text";g.className="search-query input-medium";g.id="search_pci_v";g.placeholder="Rechercher sur PCi...";var h=document.createElement("button");h.type="submit";h.className="btn";h.id="search_pci";h.innerText="OK";var j=document.createElement("div");j.style.marginTop="10px";j.style.marginLeft="0px";var k=document.createElement("select");k.id="search_pci_s";d.appendChild(a);a.appendChild(c);a.appendChild(f);f.appendChild(i);i.appendChild(g);i.appendChild(h);f.appendChild(j);j.appendChild(k);for(a=0;a<
b.length;a++)c=document.createElement("option"),c.innerText=b[a],k.appendChild(c)})();(function(){var a=document.createElement("div");a.className="pdnSearchBox";var b=document.createElement("h3");b.innerText="Prix du Net :";var f=document.createElement("form");f.className="well form-search";var i=document.createElement("div");i.className="input-append";var g=document.createElement("input");g.type="text";g.className="search-query input-medium";g.id="search_pdn_v";g.placeholder="Rechercher sur PdN...";
var h=document.createElement("button");h.type="submit";h.className="btn";h.id="search_pdn";h.innerText="OK";var j=document.createElement("div");j.style.marginTop="10px";j.style.marginLeft="0px";var k=document.createElement("select");k.id="search_pdn_s";d.appendChild(a);a.appendChild(b);a.appendChild(f);f.appendChild(i);i.appendChild(g);i.appendChild(h);f.appendChild(j);j.appendChild(k);for(a=0;a<c.length;a++)b=document.createElement("option"),b.innerText=c[a],"Produits"==c[a]&&(b.selected="selected"),
k.appendChild(b)})();(function(){document.getElementById("search_pci").addEventListener("click",function(){var a="http://www.pcinpact.com/recherche?_search="+document.getElementById("search_pci_v").value+"&_searchType=",b="http://www.pcinpact.com/emploi?_page=1&terme="+document.getElementById("search_pci_v").value;switch(document.getElementById("search_pci_s").value){case "Actualit\u00e9s":a+="1";break;case "Commentaires":a+="6";break;case "Dossiers":a+="3";break;case "Emploi":a=b;break;case "Tests":a+=
"2";break;case "INpactiens":a+="5"}chrome.tabs.create({url:a})},!1)})();(function(){document.getElementById("search_pdn").addEventListener("click",function(){var a="http://www.prixdunet.com/s/"+document.getElementById("search_pdn_v").value+".html";switch(document.getElementById("search_pdn_s").value){case "Actualit\u00e9s":a+="?type=actu";break;case "Bons plans":a="http://www.prixdunet.com/bon-plan.html?motcle="+document.getElementById("search_pdn_v").value+"&order=nb_lectures&waypopu=desc";break;
case "Dossiers":a+="?type=dossier";break;case "Tests":a+="?type=test"}chrome.tabs.create({url:a})},!1)})();document.getElementById("search_pci_v").focus()};
